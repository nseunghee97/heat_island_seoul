---
title: "이항분포의 모수에 대한 구간추정"
author: "사회학과 3학년 간정현"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 이항분포를 이용하는 경우  

```{r echo=TRUE}
thetas <- seq(0,1,0.01)
c1_vector <- vector()
c2_vector <- vector()
n = 100

for (theta in thetas){
  c1_vector = append(c1_vector, qbinom(0.025, 100, theta, lower.tail = FALSE)/100, after=length(c1_vector))
  c2_vector = append(c2_vector, qbinom(0.025, 100, theta)/100, after=length(c2_vector))
}

confidence_table = data.frame(Theta=thetas, C1=c1_vector, C2=c2_vector)
subset_table = subset(confidence_table, C1=="0.57"|C2=="0.57"); subset_table$Theta
```

각 theta에 대한 표본비율의 95% 신뢰구간을 구한 후 다시 theta를 구간추정합니다.

## 근사분포를 이용하는 경우  

````{r echo=TRUE}
p = 0.57
c(p-1.96*sqrt(p*(1-p)/n), p+1.96*sqrt(p*(1-p)/n))
```

정규분포로의 근사를 통해서 theta를 구간추정합니다. 결과는 거의 같습니다

